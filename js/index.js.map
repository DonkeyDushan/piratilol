{
  "version": 3,
  "sources": ["../../build/js/data.js", "../../build/js/helperFunctions.js", "../../build/js/index.js"],
  "sourcesContent": ["export const claims = [\r\n  \"Mladým: víte, že dokážete rozhodnout volby?\",\r\n  \"Hnutí ano prostě chce žít v minulosti bez perspektivy.\",\r\n  \"Boj s korupcí, ne udávání lidí.\",\r\n  \"Investice do sportu a kultury jsou zárukou zdravé společnosti.\",\r\n  \"Potřebujeme obnovit rovnováhu přírody!\",\r\n  \"Byty je třeba stavět, ne danit.\",\r\n  \"Nejvyšší čas zastavit zadlužování naší země!\",\r\n  \"udělejme z česka sebevědomého spojence\",\r\n  \"Místo byrokratického pekla skutečná digitalizace\",\r\n  \"Staňme se digitálním tygrem!\",\r\n  \"Veřejné finance průhledně a čistě\",\r\n  \"Dítě potřebuje náruč jedné pečující osoby!\",\r\n  \"Politik má sloužit lidem a nutit stát, aby fungoval stejně\",\r\n  \"Podpořte finančně piráty a starosty\",\r\n  \"pojďme postavit ekonomiku na nohy\",\r\n  \"2 % z rozpočtu pro armádu vybojujeme!\",\r\n  \"kultura si zaslouží 1 % z rozpočtu\",\r\n  \"na šikaně živnostníků se podílet nebudeme\",\r\n  \"skutečně digitální stát, na co máme internet?\",\r\n  \"pojďme zreformovat školství. od základů.\",\r\n  \"finance řízené podle plánu\",\r\n  \"vraťme lesům jejich zdraví\",\r\n  \"1000 korun pro každého seniora z dotací Agrofertu. Ať si pan Babiš platí předvolební dárečky ze svého.\",\r\n  \"Máme už dost nekonečných korupčních kauz. Po volbách s nimi zatočíme.\",\r\n  \"Místo jednolitých polí pestrá krajina.\",\r\n  \"je čas vyrazit pomoci na jižní moravu!\",\r\n];\r\n\r\nexport const generators = [\r\n  { url: \"https://picsum.photos/800\", weight: 5 },\r\n  /*\r\n  { url: \"https://source.unsplash.com/800x800\", weight: 10 },\r\n  { url: \"https://source.unsplash.com/800x800/?communism\", weight: 3 },\r\n  { url: \"https://source.unsplash.com/800x800/?cat\", weight: 1 },\r\n  { url: \"https://source.unsplash.com/800x800/?puppy\", weight: 1 },\r\n  { url: \"https://source.unsplash.com/800x800/?chicken\", weight: 1 },\r\n  { url: \"https://source.unsplash.com/800x800/?angry\", weight: 3 },\r\n   */\r\n];\r\n", "/* eslint-disable no-param-reassign */\r\nexport const splitText = (text, maxLineLength) => {\r\n  const result = [];\r\n  while (text.length > maxLineLength) {\r\n    let pos = text.substring(0, maxLineLength).lastIndexOf(\" \");\r\n    pos = pos <= 0 ? maxLineLength : pos;\r\n    result.push(text.substring(0, pos));\r\n    let i = text.indexOf(\" \", pos) + 1;\r\n    if (i < pos || i > pos + maxLineLength) i = pos;\r\n    text = text.substring(i);\r\n  }\r\n  result.push(text);\r\n  return result;\r\n};\r\n\r\nexport const pickRandom = (arr) => arr[Math.floor(Math.random() * arr.length)];\r\n\r\nexport const getAverageLuminance = (rgbData, pixelSkip = 6) => {\r\n  const luminanceOf = (r, g, b) => (0.2126 * r) + (0.7152 * g) + (0.0722 * b);\r\n  let luminanceSum = 0;\r\n  let luminanceDivisor = 0;\r\n  for (let i = 0; i < rgbData.length; i += 3 * pixelSkip) {\r\n    // +3 for R+G+B; pixelSkip because we don't need that many samples => less accurate, but faster!\r\n\r\n    const [r, g, b] = [rgbData[i] / 255, rgbData[i + 1] / 255, rgbData[i + 2] / 255];\r\n    const luminance = luminanceOf(r, g, b);\r\n    if (!Number.isNaN(luminance)) {\r\n      luminanceSum += luminance;\r\n      luminanceDivisor += 1;\r\n    }\r\n  }\r\n\r\n  return luminanceSum / luminanceDivisor;\r\n};\r\n", "import { claims, generators } from \"./data.js\";\r\nimport { splitText, pickRandom, getAverageLuminance } from \"./helperFunctions.js\";\r\n\r\nconst LOGO_OFFSET_X = 525;\r\nconst LOGO_OFFSET_Y = 20;\r\nconst LUMINANCE_THRESHOLD = 0.7;\r\n\r\nconst unrolledGenerators = generators.flatMap(({ url, weight }) => Array(weight).fill(url));\r\n\r\nconst imageReader = new FileReader();\r\n\r\nconst logoLight = new Image();\r\nlogoLight.src = \"public/logo-light.png\";\r\n\r\nconst logoDark = new Image();\r\nlogoDark.src = \"public/logo-dark.png\";\r\n\r\nlet currentImage = new Image();\r\nlet currentText = \"Test text\";\r\n\r\nconst rerollImage = async () => {\r\n  const imageData = await fetch(pickRandom(unrolledGenerators));\r\n\r\n  return new Promise((resolve) => {\r\n    const image = new Image();\r\n\r\n    image.addEventListener(\"load\", () => {\r\n      currentImage = image;\r\n      resolve();\r\n    });\r\n\r\n    image.crossOrigin = \"anonymous\";\r\n    image.src = imageData.url;\r\n  });\r\n};\r\n\r\nconst rerollText = () => {\r\n  currentText = pickRandom(claims);\r\n};\r\n\r\nconst canvas = document.getElementById(\"picture\");\r\nconst ctx = canvas.getContext(\"2d\");\r\nconst font = new FontFace(\"Bebas Neue\", \"url(public/BebasNeue-Bold.ttf)\");\r\n\r\nconst initFont = async () => {\r\n  await font.load();\r\n  document.fonts.add(font);\r\n};\r\n\r\nconst setFile = (file) => {\r\n  if (!file.type.startsWith(\"image/\")) {\r\n    return;\r\n  }\r\n\r\n  imageReader.readAsDataURL(file);\r\n};\r\n\r\ncanvas.addEventListener(\"dragover\", (e) => e.preventDefault());\r\n\r\ncanvas.addEventListener(\"drop\", (e) => {\r\n  e.preventDefault();\r\n  if (!e.dataTransfer || e.dataTransfer.files.length <= 0) {\r\n    return;\r\n  }\r\n\r\n  setFile(e.dataTransfer.files[0]);\r\n});\r\n\r\nconst repaintImage = async () => {\r\n  // clear to black (for transparent images)\r\n  ctx.fillStyle = \"black\";\r\n  ctx.fillRect(0, 0, canvas.width, canvas.height);\r\n\r\n  // scale image to always fill the canvas\r\n  const scaleX = canvas.width / currentImage.width;\r\n  const scaleY = canvas.height / currentImage.height;\r\n  const scale = Math.max(scaleX, scaleY);\r\n  ctx.setTransform(scale, 0, 0, scale, 0, 0);\r\n  ctx.drawImage(currentImage, 0, 0);\r\n  ctx.setTransform(); // reset so that everything else is normal size\r\n\r\n  // calculate luminance to decide whether the logo will be light or dark\r\n  const imgd = ctx\r\n    .getImageData(LOGO_OFFSET_X, LOGO_OFFSET_Y, logoLight.width, logoLight.height)\r\n    .data;\r\n  const luminanceAverage = getAverageLuminance(imgd);\r\n\r\n  if (luminanceAverage > LUMINANCE_THRESHOLD) { // make logo black if the top-right corner is bright\r\n    ctx.drawImage(logoDark, LOGO_OFFSET_X, LOGO_OFFSET_Y);\r\n  } else {\r\n    ctx.drawImage(logoLight, LOGO_OFFSET_X, LOGO_OFFSET_Y);\r\n  }\r\n\r\n  const lines = splitText(currentText, 20).reverse();\r\n  const fontSize = lines.length < 5 ? 60 : 40;\r\n  ctx.font = `${fontSize}px 'Bebas Neue'`;\r\n  lines.forEach((line, index) => {\r\n    const x = 30;\r\n    const y = 685;\r\n    const padding = 15;\r\n    const lineHeight = padding + fontSize;\r\n    ctx.fillStyle = \"#f9dc4d\";\r\n    ctx\r\n      .fillRect(x, y - (index * lineHeight), ctx.measureText(line).width + 2 * padding, lineHeight);\r\n    ctx.textBaseline = \"top\";\r\n    ctx.fillStyle = \"black\";\r\n    ctx.fillText(line, x + padding, y + padding - (index * lineHeight));\r\n  });\r\n};\r\n\r\nimageReader.addEventListener(\"load\", (e) => {\r\n  currentImage = new Image();\r\n  currentImage.addEventListener(\"load\", () => repaintImage());\r\n  currentImage.src = e.target.result;\r\n});\r\n\r\nconst buttonRandom = document.getElementById(\"randomize\");\r\nbuttonRandom.addEventListener(\"click\", async () => {\r\n  rerollText();\r\n  await rerollImage();\r\n  repaintImage();\r\n});\r\n\r\nconst buttonRandomImg = document.getElementById(\"randomize-img\");\r\nbuttonRandomImg.addEventListener(\"click\", async () => {\r\n  await rerollImage();\r\n  repaintImage();\r\n});\r\n\r\nconst buttonRandomText = document.getElementById(\"randomize-text\");\r\nbuttonRandomText.addEventListener(\"click\", () => {\r\n  rerollText();\r\n  repaintImage();\r\n});\r\n\r\nconst inputCustomImg = document.getElementById(\"customImage\");\r\ninputCustomImg.addEventListener(\"change\", (e) => {\r\n  e.preventDefault();\r\n  if (e.target.files.length <= 0) {\r\n    return;\r\n  }\r\n  setFile(e.target.files[0]);\r\n});\r\nconst buttonCustomImg = document.getElementById(\"customImageBtn\");\r\nbuttonCustomImg.addEventListener(\"click\", () => {\r\n  inputCustomImg.click();\r\n});\r\n\r\nconst inputCustom = document.getElementById(\"customText\");\r\nconst replaceWithCustomText = async (e) => {\r\n  if (e.type === \"input\" || inputCustom.value) {\r\n    currentText = inputCustom.value;\r\n    repaintImage();\r\n  }\r\n};\r\ninputCustom.addEventListener(\"click\", replaceWithCustomText);\r\ninputCustom.addEventListener(\"input\", replaceWithCustomText);\r\n\r\nconst downloadLinkReal = document.createElement(\"a\");\r\ndownloadLinkReal.setAttribute(\"download\", \"PirStanKampan.jpg\");\r\nconst linkSave = document.getElementById(\"save\");\r\nlinkSave.addEventListener(\"click\", (e) => {\r\n  e.preventDefault();\r\n  downloadLinkReal.setAttribute(\"href\", canvas.toDataURL(\"image/jpeg\").replace(\"image/jpeg\", \"image/octet-stream\"));\r\n  downloadLinkReal.click();\r\n});\r\n\r\ninitFont();\r\n\r\nrerollText();\r\nrerollImage()\r\n  .then(() => repaintImage());\r\n"],
  "mappings": "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",
  "names": []
}
